{"title":"Local Event Website Environment for Dynamics Marketing","date":"2022-10-06T17:34:07.000Z","date_formatted":{"ll":"2022年10月6日","L":"2022/10/06","MM-DD":"10-06"},"thumbnail":"https://ichrisj.gitee.io/reslib/images/local-event-website-environment-for-Dynamics-Marketing/local-event-website-environment-for-Dynamics-Marketing.jpg","link":"2022/10/06/local-event-website-environment-for-Dynamics-Marketing","comments":true,"tags":["Dynamics Marketing","Event Portal","Power Apps Portal"],"updated":"2022-10-08T14:56:27.935Z","content":"<p>In Dynamics Marketing, the event management feature helps you to organize, manage, and process the events. When you install the event management solution, you get an event portal that gives the users a web application where they can get to know more about the event details.</p>\n<p>Event Portal is not like other types of Portals using Portal Editor in <a href=\"https://make.powerapps.com\">https://make.powerapps.com</a>, or updating configuration records in Dataverse to change the UI and add functionalities. It doesn’t mean those ways totally do not work, but not the recommended ways. Event Portal is built using the Angular framework, so you need to have some knowledge of Angular to customize it. Here let’s set up a local Event Portal development environment and how push changes to Event Portal.</p>\n<h2 id=\"1.-set-up-an-angular-environment\">1. Set up an Angular environment<a title=\"#1.-set-up-an-angular-environment\" href=\"#1.-set-up-an-angular-environment\"></a></h2>\n<p>To install Angular on your local system, you need the following:</p>\n<ol>\n<li>Install <a href=\"https://nodejs.org/en/download\" target=\"_blank\">Node.js</a> version 10.x or higher.</li>\n<li>Open Command Prompt or Windows PowerShell and run the command to check whether the installation was successful.<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node <span class=\"literal\">-v</span></span><br></pre></td></tr></table></figure>\n</li>\n<li>Run the command to install the <a href=\"https://angular.io/cli\" target=\"_blank\">Angular CLI</a> (command-line interface) required to build and run the Angular application.<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install <span class=\"literal\">-g</span> @angular/<span class=\"built_in\">cli</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>[!Note]<br>\nOn Windows client computers, the execution of PowerShell scripts is disabled by default. To allow the execution of PowerShell scripts, which is needed for npm global binaries, you must set the following execution policy:</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Set-ExecutionPolicy</span> <span class=\"literal\">-Scope</span> CurrentUser <span class=\"literal\">-ExecutionPolicy</span> RemoteSigned</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n<li>Make sure you have an IDE to develop Angular website. <a href=\"https://code.visualstudio.com/\" target=\"_blank\">Visual Studio Code</a> is a good option. You can install and use it develop your application, but not mandatory.</li>\n</ol>\n<h2 id=\"2.-download-the-sample-code\">2. Download the sample code<a title=\"#2.-download-the-sample-code\" href=\"#2.-download-the-sample-code\"></a></h2>\n<ol>\n<li>Download the latest <a href=\"https://learn.microsoft.com/dynamics365/marketing/developer/event-management-web-application#download-sample-event-website\" target=\"_blank\">source code for the sample event website</a></li>\n<li>Extract the code onto somewhere and open the “release” folder in VS Code.<br>\n<img src=\"//ichrisj.gitee.io/reslib/images//local-event-website-environment-for-Dynamics-Marketing/download-sample-code.png?m=webp&amp;q=80\" alt=\"download-sample-code\" loading=\"lazy\"></li>\n<li>Back to the Command Prompt or PowerShell, and navigate to “release” folder where the source code is downloaded, run the command <code>npm install</code> to fetch all the necessary packages required to run the website. <figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install</span><br></pre></td></tr></table></figure>\n<img src=\"//ichrisj.gitee.io/reslib/images//local-event-website-environment-for-Dynamics-Marketing/npm-install.png?m=webp&amp;q=80\" alt=\"npm-install\" loading=\"lazy\" class=\"φbp\"></li>\n</ol>\n<h2 id=\"3.-power-apps-portal-hosted-event-website\">3. Power Apps Portal hosted event website<a title=\"#3.-power-apps-portal-hosted-event-website\" href=\"#3.-power-apps-portal-hosted-event-website\"></a></h2>\n<p>There are some differences of event website hosted on Event Portal or Self-hosted. If an Event Portal is provisioned for the Dynamics Marketing environment, we can customize the website locally, then push the changes to the Event Portal.</p>\n<ol>\n<li>\n<p>Once the “release” folder is opened in the VS Code, please copy all content from <code>environment.d365.ts</code> to <code>environment.ts</code> in <code>src\\environments\\</code> folder.</p>\n</li>\n<li>\n<p>Once copied, please update the <code>apiEndpoint</code> to the Event Portal url.<br>\n<img src=\"//ichrisj.gitee.io/reslib/images//local-event-website-environment-for-Dynamics-Marketing/d365-environment.png?m=webp&amp;q=80\" alt=\"d365-environment\" loading=\"lazy\"></p>\n<blockquote>\n<p>[!Note]<br>\nMake sure the trailing slash <strong><code>/</code></strong> is at the end of the URL</p>\n<p>If the Event Portal is configured the custom domain, please use the custom url instead.</p>\n</blockquote>\n</li>\n<li>\n<p>Go the Portal Management app in the Marketing environment, create a Site Setting record with <strong>Name</strong> as <em>HTTP/Access-Control-Allow-Origin</em> and <strong>Value</strong> as <em><a href=\"https://localhost:4200\">https://localhost:4200</a></em><br>\n<img src=\"//ichrisj.gitee.io/reslib/images//local-event-website-environment-for-Dynamics-Marketing/sitesetting.png?m=webp&amp;q=80\" alt=\"sitesetting\" loading=\"lazy\"></p>\n</li>\n<li>\n<p>Back to the Command Prompt or Windows PowerShell and run the command from the root directory to build and locally serve the website.</p>\n <figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng serve -<span class=\"literal\">-ssl</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"//ichrisj.gitee.io/reslib/images//local-event-website-environment-for-Dynamics-Marketing/d365-ng-serve.png?m=webp&amp;q=80\" alt=\"d365-ng-serve\" loading=\"lazy\" class=\"φbp\"></p>\n</li>\n<li>\n<p>Access <a href=\"https://localhost:4200\">https://localhost:4200</a> in browser to open the website. Now you can update the source code in VS Code, then see the change reflect in the website.</p>\n</li>\n<li>\n<p>Deploy the changes to Event Portal.</p>\n<ol>\n<li>Once you complete the customizations in source code, you want push the changes to the Event Portal, please run the script <code>Scripts\\DeployToDynamics365Instance.ps1</code> in PowerShell.</li>\n<li>The script will build the source code first, then pop up an Interactive Login for you to login the Dataverse environment.</li>\n<li>After login, select the target environment, then the changes will be pushed to the environment.<br>\n<img src=\"//ichrisj.gitee.io/reslib/images//local-event-website-environment-for-Dynamics-Marketing/deployment.png?m=webp&amp;q=80\" alt=\"deployment\" loading=\"lazy\"></li>\n</ol>\n</li>\n<li>\n<p>Afterwards, the customizations will be reflected in the Event Portal. (<a href=\"https://learn.microsoft.com/power-apps/maker/portals/admin/clear-server-side-cache#steps-to-clear-portal-server-side-cache\" target=\"_blank\">Clear cache</a> if the customizations don’t show in time.)</p>\n</li>\n</ol>\n<h2 id=\"4.-self-hosted-event-website\">4. Self-hosted event website<a title=\"#4.-self-hosted-event-website\" href=\"#4.-self-hosted-event-website\"></a></h2>\n<p>If no Event Portal provisioned for the Dynamics Marketing environment, you can also set up the local event to customize the event website, but you need manually deploy the code to IIS, Azure Web App, etc.</p>\n<ol>\n<li>Once the “release” folder is opened in the VS Code, please copy all content from <code>environment.selfhosted.ts</code> to <code>environment.ts</code> in <code>src\\environments\\</code> folder.</li>\n<li>Open the Marketing environment, navigate to Settings &gt; Event management &gt; Web applications from SiteMap.</li>\n<li>Try to create a Web application record for local testing, set the <strong>Origin</strong> to <code>http://localhost:4200</code> which we will launch the website in the URL by default. Save the record, then the values of <strong>Token</strong> and <strong>Endpoint</strong> will be generated automatically. Copy the values.<br>\n<img src=\"//ichrisj.gitee.io/reslib/images//local-event-website-environment-for-Dynamics-Marketing/web-application.png?m=webp&amp;q=80\" alt=\"web-application\" loading=\"lazy\"></li>\n<li>Go back to the <code>environment.ts</code> in VS Code and update <code>apiEndpoint</code> with value from <strong>Endpoint</strong> and set <code>emApplicationtoken</code> to the value of <strong>Token</strong><br>\n<img src=\"//ichrisj.gitee.io/reslib/images//local-event-website-environment-for-Dynamics-Marketing/selfhosted-environment.png?m=webp&amp;q=80\" alt=\"\" loading=\"lazy\"></li>\n<li>Go back to the Command Prompt or Windows PowerShell and run the command from the root directory to build and locally serve the website. <figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng serve</span><br></pre></td></tr></table></figure>\n<img src=\"//ichrisj.gitee.io/reslib/images//local-event-website-environment-for-Dynamics-Marketing/selfhosted-ng-serve.png?m=webp&amp;q=80\" alt=\"selfhosted-ng-serve\" loading=\"lazy\" class=\"φbp\"></li>\n<li>Access <a href=\"http://localhost:4200\">http://localhost:4200</a> in browser to open the website.</li>\n</ol>\n<blockquote>\n<p>[!TIP]<br>\nIf the <strong>Origin</strong> is to <code>https://localhost:4200</code> in step 3, then you need to use the command <code>ng serve -ssl</code> to run and open the website via <code>https://localhost:4200</code></p>\n</blockquote>\n<h2 id=\"references\">References<a title=\"#references\" href=\"#references\"></a></h2>\n<p><a href=\"https://learn.microsoft.com/en-us/dynamics365/marketing/developer/event-management-web-application\">https://learn.microsoft.com/en-us/dynamics365/marketing/developer/event-management-web-application</a><br>\n<a href=\"https://learn.microsoft.com/en-us/dynamics365/marketing/developer/portal-hosted\">https://learn.microsoft.com/en-us/dynamics365/marketing/developer/portal-hosted</a><br>\n<a href=\"https://learn.microsoft.com/en-us/dynamics365/marketing/developer/self-hosted\">https://learn.microsoft.com/en-us/dynamics365/marketing/developer/self-hosted</a></p>\n","next":{"title":"Power Apps Portal中JSON type Web Template的使用","link":"2022/09/15/json-type-web-template-in-portals"},"plink":"http://b.alphac.cn/2022/10/06/local-event-website-environment-for-Dynamics-Marketing/","toc":[{"id":"1.-set-up-an-angular-environment","title":"1. Set up an Angular environment","index":"1"},{"id":"2.-download-the-sample-code","title":"2. Download the sample code","index":"2"},{"id":"3.-power-apps-portal-hosted-event-website","title":"3. Power Apps Portal hosted event website","index":"3"},{"id":"4.-self-hosted-event-website","title":"4. Self-hosted event website","index":"4"},{"id":"references","title":"References","index":"5"}],"copyright":{"link":"<a href=\"http://b.alphac.cn/2022/10/06/local-event-website-environment-for-Dynamics-Marketing/\" title=\"Local Event Website Environment for Dynamics Marketing\">http://b.alphac.cn/2022/10/06/local-event-website-environment-for-Dynamics-Marketing/</a>","license":"自由转载-非商用-禁止演绎-保持署名 (<a href=\"https://creativecommons.org/licenses/by-nc-nd/4.0/\" target=\"_blank\">CC BY-NC-ND 4.0</a>)","published":"2022年10月6日"},"reading_time":"1090 字约 9 分钟"}