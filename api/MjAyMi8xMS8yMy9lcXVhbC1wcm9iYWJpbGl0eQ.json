{"title":"等概率随机函数问题","date":"2022-11-23T21:01:28.000Z","date_formatted":{"ll":"Nov 23, 2022","L":"11/23/2022","MM-DD":"11-23"},"thumbnail":"https://ichrisj.gitee.io/reslib/images/equal-probability/equal-probability.jpg","link":"2022/11/23/equal-probability","comments":true,"tags":["LeetCode"],"categories":["Algorithms"],"updated":"2022-11-23T13:09:49.409Z","content":"<p>LeetCode470题中给定一个等概率随机生成1 ~ 7的函数，要求实现等概率返回1 ~ 10的函数。该题的解法有很多，今天介绍一下下面的解题逻辑。它是一个通用逻辑，之后如果遇到其他给定一个等概率随机生成a ~ b的函数，要求实现等概率返回c ~ d的函数，我们也可以完全套用。</p>\n<h1 id=\"解题逻辑\">解题逻辑<a title=\"#解题逻辑\" href=\"#解题逻辑\"></a></h1>\n<ul>\n<li>通过给定的等概率随机函数求出等概率生成0和1的函数</li>\n<li>数字二进制转换，求取目标范围等概率随机函数</li>\n</ul>\n<h3 id=\"等概率生成0和1的函数\">等概率生成0和1的函数<a title=\"#等概率生成0和1的函数\" href=\"#等概率生成0和1的函数\"></a></h3>\n<p>如果1 ~ 7范围中包含偶数个数字，那很好办，我们就可以让<code>Rand7</code>生成的数字是范围上半部分的时候返回0，下半部分的时候返回1。但是1 ~ 7中包含奇数个数字，该怎么处理呢？<br>\n那就让<code>Rand7</code>生成的数字是4的时候，不要返回，循环调用<code>Rand7</code>, 直到不是4. 这样生成0和1的概率就是相等的</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">int</span> <span class=\"title\">Rand2</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">int</span> num = Rand7();</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(num == <span class=\"number\">4</span>)</span><br><span class=\"line\">        num = Rand7();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> num &lt; <span class=\"number\">4</span> ? <span class=\"number\">0</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"求取目标范围等概率随机函数\">求取目标范围等概率随机函数<a title=\"#求取目标范围等概率随机函数\" href=\"#求取目标范围等概率随机函数\"></a></h1>\n<p>现在我们有了<code>Rand2</code>函数可以等概率获取0和1，如何等概率生成1 ~ 10呢？<br>\n首先，1 ~ 10的范围可以看成 0 ~ 9的范围，就是每一个数+1. 对于9，如果用二进制的话，我们需要5个二进制位来表示。也就是说，如果我们用<code>Rand2</code>函数跑5次，生成的0和1组合就有可能0 ~ 9范围的数。但是5个二进制位生成数字的范围是0 ~ 15，那么就有可能生成大于9的数，怎么办呢？跟上面一样，重新生成。</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">int</span> <span class=\"title\">Rand10</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">int</span> ans = (Rand2() &lt;&lt; <span class=\"number\">4</span>) + (Rand2() &lt;&lt; <span class=\"number\">3</span>) + (Rand2() &lt;&lt; <span class=\"number\">2</span>) + (Rand2() &lt;&lt; <span class=\"number\">1</span>) + Rand2();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(ans &gt; <span class=\"number\">9</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Rand10();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ans + <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>那么之后遇到类似的问题，给定一个等概率随机生成a ~ b的函数，要求实现等概率返回c ~ d的函数，这就变得很简单了。通过生成a ~ b的函数计算出等概率获取0和1的函数<code>Rand2</code>。然后将d用二进制表示, 调用<code>Rand2</code>生成每一位的数。如果生成的数组合后不在c ~ d的范围，重新生成。</p>\n<h1 id=\"问题扩展\">问题扩展<a title=\"#问题扩展\" href=\"#问题扩展\"></a></h1>\n<p>我们来扩展一下该问题：如果现在有一个函数可以生成 0 和 1，但不是等概率的，那么如果获得一个等概率生成0和1的函数呢？<br>\n假设该函数生成 0 的概率是 P, 那么生成1的概率就是 1-P。如果调用该函数俩次，生成 0 1 和 1 0 的概率都是 P*(1-P)，如果生成他们俩是分别返回 0 和 1 ，那么此时生成的组合是 0 0 或者 1 1 呢？ 重新生成。</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">int</span> <span class=\"title\">UpdatedRand2</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">int</span> ans = Rand2();</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(ans == Rand2())</span><br><span class=\"line\">       <span class=\"keyword\">return</span> UpdatedRand2();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","next":{"title":"Local Event Website Environment for Dynamics Marketing","link":"2022/10/06/local-event-website-environment-for-Dynamics-Marketing"},"plink":"https://blog.citysouth.cc/2022/11/23/equal-probability/","toc":[{"id":"解题逻辑","title":"解题逻辑","index":"1","children":[{"id":"等概率生成0和1的函数","title":"等概率生成0和1的函数","index":"1.1"}]}],"copyright":{"link":"<a href=\"https://blog.citysouth.cc/2022/11/23/equal-probability/\" title=\"等概率随机函数问题\">https://blog.citysouth.cc/2022/11/23/equal-probability/</a>","license":"自由转载-非商用-禁止演绎-保持署名 Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-nd/4.0/\" target=\"_blank\">CC BY-NC-ND 4.0</a>)","published":"November 23, 2022"},"reading_time":"773 words in 6 min"}